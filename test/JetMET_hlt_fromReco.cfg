#
# CMSSW cfg file for HLT JetMET trigger paths.
# Assumes jet reconstruction has already been carried out
#
process JetMetHLT  = {

    #include "Configuration/StandardSequences/data/FakeConditions.cff"
    #include "input/defaultInput_150.cfi"
    #include "input/mc-onsel-120_QCD_pt_470_600.cff"

    source = PoolSource { 
    	untracked vstring fileNames = {
    	    "file:hltInput.root"}
    }
    untracked PSet maxEvents = {untracked int32 input = 100}
    
    # service = Timing {}

    # unpacking and level-1 setup
    include "HLTrigger/Configuration/data/common/HLTSetup.cff"
    # define a dummy reco sequence to use in the HLT paths for the case of already reconstructed data
    module  recodummy = hltPrescaler from "HLTrigger/HLTcore/data/hltPrescaler.cfi"
    replace recodummy.makeFilterObject = false

    include "HLTrigger/Configuration/data/common/RecoJetMET.cff"
    sequence recoJetMETPath = {recodummy & MCJetCorJetIcone5 & doHLTHTReco} # HT not done by default

    //replace l1extraParticleMap.A_SingleJet15_prescale = 1
    //replace l1extraParticleMap.A_SingleJet20_prescale = 1
    //replace l1extraParticleMap.A_SingleJet50_prescale = 1
    //replace l1extraParticleMap.A_SingleJet100_prescale = 1

    # -- l1extra from MCTruth
    #include "HLTrigger/JetMET/data/l1seeds_fromMCTruth.cff"
    
    # -- l1emulator from MC Digis
    include "HLTrigger/JetMET/data/l1seeds_fromGCT.cff"

    # the JetMet trigger paths
    include "HLTrigger/JetMET/test/JetMET_paths.cff"


    module out = PoolOutputModule {
	untracked string fileName = "hltOutput_fromReco.root"
	untracked vstring outputCommands =
	{ # drop a bunch of branches to keep output file size reasonable
	    "drop *",
	    "keep CaloTowersSorted_*_*_*",
	    "keep recoCaloJets_*_*_*",
	    "keep recoGenJets_*_*_*",
	    "keep recoCaloMETs_*_*_*",
	    "keep recoGenMETs_*_*_*",
	    "keep recoMETs_*_*_*",
	    "keep recoHLTFilterObjectBase_*_*_*",
	    "keep recoHLTFilterObjectWithRefs_*_*_*",
	    "keep recoHLTPathObject_*_*_*",
	    "keep recoHLTGlobalObject_*_*_*",
	    //"keep recoCandidatesOwned_*_*_*",
	    "keep l1extraL1EmParticles_*_*_*",
	    "keep l1extraL1EtMissParticle_*_*_*",
	    "keep l1extraL1JetParticles_*_*_*",
	    "keep l1extraL1MuonParticles_*_*_*",
	    "keep l1extraL1ParticleMaps_*_*_*",
	    "keep edmHepMCProduct_*_*_*",
	    "keep edmTriggerResults_*_*_*"
	}
    }
    #replace out.outputCommands = { "keep *" }

    endpath outpath = { out }
}
